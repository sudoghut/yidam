(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{58:(e,t,n)=>{Promise.resolve().then(n.bind(n,4360))},4360:(e,t,n)=>{"use strict";n.d(t,{default:()=>u});var r=n(5155),l=n(2115),o=n(6658),s=n(1956),c=n.n(s);function a(e){let{children:t,...n}=e,[o,s]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{s(!0)},[]),o)?(0,r.jsx)("div",{...n,children:t}):null}function u(){let e=(0,o.useSearchParams)(),[t,s]=(0,l.useState)([]),[u,d]=(0,l.useState)(""),[i,f]=(0,l.useState)(!1),[b,h]=(0,l.useState)(!1),p=(0,l.useRef)(null),m=(0,l.useRef)(null),x=c()(()=>n.e(84).then(n.bind(n,3084)).then(e=>e.QRCodeSVG),{loadableGenerated:{webpack:()=>[null]},ssr:!1}),g="chat"===e.get("interface"),y=window.location.href.split("/")[2].split(":")[0];(0,l.useEffect)(()=>(g&&f(!0),y&&(m.current=new WebSocket("ws://".concat(y,":").concat(3001,"/ws")),console.log("Connecting to:","ws://".concat(y,":").concat(3001,"/ws")),m.current.onopen=()=>{console.log("WebSocket connected"),h(!0)},m.current.onmessage=e=>{let t=e.data;"[START]"===t?s(e=>[...e,{sender:"LLM",content:""}]):"[END]"===t||s(e=>{if(0===e.length)return e;let n=[...e];return n[n.length-1].content+=t,n})},m.current.onerror=e=>{console.error("WebSocket error:",e)},m.current.onclose=e=>{console.log("WebSocket closed:",e.code,e.reason),h(!1)}),()=>{m.current&&m.current.close()}),[y,g]),(0,l.useEffect)(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[t]);let j=()=>{u&&m.current&&m.current.readyState===WebSocket.OPEN?(s(e=>[...e,{sender:"You",content:u}]),console.log("Sending:",u),m.current.send(u),console.log("Sent:",u),d("")):m.current&&m.current.readyState===WebSocket.OPEN||console.error("WebSocket is not connected")};return(0,r.jsxs)(a,{children:[!i&&(0,r.jsxs)("div",{className:"text-center mb-5",children:[(0,r.jsx)(x,{value:"http://".concat(y,":").concat(3001,"/web/?interface=chat"),size:256,className:"mx-auto mb-4"},"http://".concat(y,":").concat(3001,"/web/?interface=chat")),(0,r.jsx)("button",{onClick:()=>f(!0),className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Simulate QR Code Scan"})]}),i&&(0,r.jsxs)("div",{className:"flex flex-col h-[500px]",children:[(0,r.jsxs)("div",{className:"mb-2",children:["Connection status: ",b?"Connected":"Disconnected"]}),(0,r.jsx)("div",{ref:p,className:"flex-grow overflow-y-auto border border-gray-300 p-3 mb-3",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("span",{className:"font-bold",children:[e.sender,":"]})," ",e.content]},t))}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("input",{type:"text",value:u,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"===e.key&&j()},placeholder:"Type your message...",className:"flex-grow border border-gray-300 p-2 mr-2"}),(0,r.jsx)("button",{onClick:j,disabled:!b,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded ".concat(!b&&"opacity-50 cursor-not-allowed"),children:"Send"})]})]})]})}},1956:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let r=n(306)._(n(580));function l(e,t){var n;let l={};"function"==typeof e&&(l.loader=e);let o={...l,...t};return(0,r.default)({...o,modules:null==(n=o.loadableGenerated)?void 0:n.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9827:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let r=n(3719);function l(e){let{reason:t,children:n}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return n}},580:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return u}});let r=n(5155),l=n(2115),o=n(9827),s=n(9214);function c(e){return{default:e&&"default"in e?e.default:e}}let a={loader:()=>Promise.resolve(c(()=>null)),loading:null,ssr:!0},u=function(e){let t={...a,...e},n=(0,l.lazy)(()=>t.loader().then(c)),u=t.loading;function d(e){let c=u?(0,r.jsx)(u,{isLoading:!0,pastDelay:!0,error:null}):null,a=!t.ssr||!!t.loading,d=a?l.Suspense:l.Fragment,i=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(s.PreloadChunks,{moduleIds:t.modules}):null,(0,r.jsx)(n,{...e})]}):(0,r.jsx)(o.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(n,{...e})});return(0,r.jsx)(d,{...a?{fallback:c}:{},children:i})}return d.displayName="LoadableComponent",d}},9214:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return c}});let r=n(5155),l=n(7650),o=n(5861),s=n(8284);function c(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let n=o.workAsyncStorage.getStore();if(void 0===n)return null;let c=[];if(n.reactLoadableManifest&&t){let e=n.reactLoadableManifest;for(let n of t){if(!e[n])continue;let t=e[n].files;c.push(...t)}}return 0===c.length?null:(0,r.jsx)(r.Fragment,{children:c.map(e=>{let t=n.assetPrefix+"/_next/"+(0,s.encodeURIPath)(e);return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,l.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(58)),_N_E=e.O()}]);